{% extends "base_internal.html" %}
{% load wagtailcore_tags %}

{% block internal_content %}
<div class="container-fluid py-5" style="background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%); min-height: 100vh;">
    <!-- Hero Section -->
    <div class="container py-5 text-center text-white">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <h1 class="display-3 fw-bold mb-4">{{ page.hero_title }}</h1>
                <p class="lead mb-5">{{ page.hero_subtitle }}</p>
            </div>
        </div>
    </div>

    <!-- Formulário Section -->
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="bg-dark p-5 rounded shadow-lg text-white">
                    <div class="lead text-white-50 mb-4">
                        {{ page.form_instructions|richtext }}
                    </div>
                    
                    <!-- Formulário de Candidatura -->
                    <form id="recruitmentForm" enctype="multipart/form-data">
                        {% csrf_token %}
                        
                        <!-- Passo 1: Dados Pessoais -->
                        <div class="form-step" id="step1">
                            <h3 class="text-pink mb-4">
                                <i class="fas fa-user me-2"></i>Passo 1: Dados Pessoais
                            </h3>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="full_name" class="form-label">Nome Completo *</label>
                                    <input type="text" class="form-control" id="full_name" name="full_name" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="email" class="form-label">E-mail *</label>
                                    <input type="email" class="form-control" id="email" name="email" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="phone" class="form-label">Telefone *</label>
                                    <input type="tel" class="form-control" id="phone" name="phone" placeholder="(11) 99999-9999" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="birth_date" class="form-label">Data de Nascimento *</label>
                                    <input type="date" class="form-control" id="birth_date" name="birth_date" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="cpf" class="form-label">CPF *</label>
                                    <input type="text" class="form-control" id="cpf" name="cpf" placeholder="000.000.000-00" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="rg" class="form-label">RG *</label>
                                    <input type="text" class="form-control" id="rg" name="rg" required>
                                </div>
                                <div class="col-12">
                                    <label for="address" class="form-label">Endereço Completo *</label>
                                    <textarea class="form-control" id="address" name="address" rows="2" required></textarea>
                                </div>
                                <div class="col-md-4">
                                    <label for="city" class="form-label">Cidade *</label>
                                    <input type="text" class="form-control" id="city" name="city" required>
                                </div>
                                <div class="col-md-4">
                                    <label for="state" class="form-label">Estado *</label>
                                    <select class="form-control" id="state" name="state" required>
                                        <option value="">Selecione</option>
                                        <option value="AC">Acre</option>
                                        <option value="AL">Alagoas</option>
                                        <option value="AP">Amapá</option>
                                        <option value="AM">Amazonas</option>
                                        <option value="BA">Bahia</option>
                                        <option value="CE">Ceará</option>
                                        <option value="DF">Distrito Federal</option>
                                        <option value="ES">Espírito Santo</option>
                                        <option value="GO">Goiás</option>
                                        <option value="MA">Maranhão</option>
                                        <option value="MT">Mato Grosso</option>
                                        <option value="MS">Mato Grosso do Sul</option>
                                        <option value="MG">Minas Gerais</option>
                                        <option value="PA">Pará</option>
                                        <option value="PB">Paraíba</option>
                                        <option value="PR">Paraná</option>
                                        <option value="PE">Pernambuco</option>
                                        <option value="PI">Piauí</option>
                                        <option value="RJ">Rio de Janeiro</option>
                                        <option value="RN">Rio Grande do Norte</option>
                                        <option value="RS">Rio Grande do Sul</option>
                                        <option value="RO">Rondônia</option>
                                        <option value="RR">Roraima</option>
                                        <option value="SC">Santa Catarina</option>
                                        <option value="SP">São Paulo</option>
                                        <option value="SE">Sergipe</option>
                                        <option value="TO">Tocantins</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="zip_code" class="form-label">CEP *</label>
                                    <input type="text" class="form-control" id="zip_code" name="zip_code" placeholder="00000-000" required>
                                </div>
                            </div>
                            <div class="text-end mt-4">
                                <button type="button" class="btn btn-pink" onclick="nextStep(2)">
                                    Próximo <i class="fas fa-arrow-right ms-2"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Passo 2: Informações Profissionais -->
                        <div class="form-step d-none" id="step2">
                            <h3 class="text-pink mb-4">
                                <i class="fas fa-briefcase me-2"></i>Passo 2: Informações Profissionais
                            </h3>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="current_position" class="form-label">Cargo Atual *</label>
                                    <input type="text" class="form-control" id="current_position" name="current_position" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="current_company" class="form-label">Empresa Atual *</label>
                                    <input type="text" class="form-control" id="current_company" name="current_company" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="experience_years" class="form-label">Anos de Experiência *</label>
                                    <input type="number" class="form-control" id="experience_years" name="experience_years" min="0" max="50" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="education_level" class="form-label">Escolaridade *</label>
                                    <select class="form-control" id="education_level" name="education_level" required>
                                        <option value="">Selecione</option>
                                        <option value="ensino_medio">Ensino Médio</option>
                                        <option value="tecnico">Técnico</option>
                                        <option value="superior_incompleto">Superior Incompleto</option>
                                        <option value="superior_completo">Superior Completo</option>
                                        <option value="pos_graduacao">Pós-Graduação</option>
                                        <option value="mestrado">Mestrado</option>
                                        <option value="doutorado">Doutorado</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="course_name" class="form-label">Curso/Graduação *</label>
                                    <input type="text" class="form-control" id="course_name" name="course_name" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="institution" class="form-label">Instituição de Ensino *</label>
                                    <input type="text" class="form-control" id="institution" name="institution" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="desired_area" class="form-label">Área de Interesse *</label>
                                    <select class="form-control" id="desired_area" name="desired_area" required>
                                        <option value="">Selecione</option>
                                        <option value="marketing_digital">Marketing Digital</option>
                                        <option value="desenvolvimento">Desenvolvimento</option>
                                        <option value="vendas">Vendas</option>
                                        <option value="design">Design</option>
                                        <option value="copywriting">Copywriting</option>
                                        <option value="analytics">Analytics</option>
                                        <option value="gestao_projetos">Gestão de Projetos</option>
                                        <option value="atendimento">Atendimento</option>
                                        <option value="rh">Recursos Humanos</option>
                                        <option value="financeiro">Financeiro</option>
                                        <option value="administrativo">Administrativo</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="availability" class="form-label">Disponibilidade *</label>
                                    <select class="form-control" id="availability" name="availability" required>
                                        <option value="">Selecione</option>
                                        <option value="imediata">Imediata</option>
                                        <option value="15_dias">15 dias</option>
                                        <option value="30_dias">30 dias</option>
                                        <option value="60_dias">60 dias</option>
                                        <option value="90_dias">90 dias</option>
                                        <option value="negociavel">Negociável</option>
                                    </select>
                                </div>
                                <div class="col-12">
                                    <label for="technical_skills" class="form-label">Habilidades Técnicas *</label>
                                    <textarea class="form-control" id="technical_skills" name="technical_skills" rows="3" 
                                              placeholder="Descreva suas principais habilidades técnicas, ferramentas que domina, etc." required></textarea>
                                </div>
                                <div class="col-12">
                                    <label for="languages" class="form-label">Idiomas *</label>
                                    <textarea class="form-control" id="languages" name="languages" rows="2" 
                                              placeholder="Ex: Português (nativo), Inglês (fluente), Espanhol (intermediário)" required></textarea>
                                </div>
                                <div class="col-12">
                                    <label for="certifications" class="form-label">Certificações</label>
                                    <textarea class="form-control" id="certifications" name="certifications" rows="2" 
                                              placeholder="Certificações relevantes, cursos, etc."></textarea>
                                </div>
                            </div>
                            <div class="d-flex justify-content-between mt-4">
                                <button type="button" class="btn btn-outline-light" onclick="prevStep(1)">
                                    <i class="fas fa-arrow-left me-2"></i>Voltar
                                </button>
                                <button type="button" class="btn btn-pink" onclick="nextStep(3)">
                                    Próximo <i class="fas fa-arrow-right ms-2"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Passo 3: Experiência com Ferramentas -->
                        <div class="form-step d-none" id="step3">
                            <h3 class="text-pink mb-4">
                                <i class="fas fa-tools me-2"></i>Passo 3: Experiência com Ferramentas
                            </h3>
                            <div class="row g-3">
                                <div class="col-12">
                                    <p class="text-white-50 mb-4">Marque as ferramentas com as quais você tem experiência:</p>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="crm_experience" name="crm_experience">
                                        <label class="form-check-label text-white" for="crm_experience">
                                            CRM (HubSpot, Salesforce, RD Station, etc.)
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="social_media_experience" name="social_media_experience">
                                        <label class="form-check-label text-white" for="social_media_experience">
                                            Redes Sociais (Facebook, Instagram, LinkedIn, etc.)
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="google_ads_experience" name="google_ads_experience">
                                        <label class="form-check-label text-white" for="google_ads_experience">
                                            Google Ads
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="facebook_ads_experience" name="facebook_ads_experience">
                                        <label class="form-check-label text-white" for="facebook_ads_experience">
                                            Facebook Ads
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="analytics_experience" name="analytics_experience">
                                        <label class="form-check-label text-white" for="analytics_experience">
                                            Analytics (Google Analytics, Facebook Analytics, etc.)
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="seo_experience" name="seo_experience">
                                        <label class="form-check-label text-white" for="seo_experience">
                                            SEO
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="content_creation_experience" name="content_creation_experience">
                                        <label class="form-check-label text-white" for="content_creation_experience">
                                            Criação de Conteúdo
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex justify-content-between mt-4">
                                <button type="button" class="btn btn-outline-light" onclick="prevStep(2)">
                                    <i class="fas fa-arrow-left me-2"></i>Voltar
                                </button>
                                <button type="button" class="btn btn-pink" onclick="nextStep(4)">
                                    Próximo <i class="fas fa-arrow-right ms-2"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Passo 4: Motivação e Expectativas -->
                        <div class="form-step d-none" id="step4">
                            <h3 class="text-pink mb-4">
                                <i class="fas fa-heart me-2"></i>Passo 4: Motivação e Expectativas
                            </h3>
                            <div class="row g-3">
                                <div class="col-12">
                                    <label for="motivation" class="form-label">Motivação *</label>
                                    <textarea class="form-control" id="motivation" name="motivation" rows="4" 
                                              placeholder="Conte-nos o que te motiva a trabalhar na Kaizen e como você pode contribuir para nossa missão." required></textarea>
                                </div>
                                <div class="col-12">
                                    <label for="salary_expectation" class="form-label">Pretensão Salarial *</label>
                                    <input type="text" class="form-control" id="salary_expectation" name="salary_expectation" 
                                           placeholder="Ex: R$ 3.000 - R$ 5.000" required>
                                </div>
                                <div class="col-12">
                                    <label for="career_goals" class="form-label">Objetivos de Carreira *</label>
                                    <textarea class="form-control" id="career_goals" name="career_goals" rows="3" 
                                              placeholder="Onde você se vê profissionalmente nos próximos 3-5 anos?" required></textarea>
                                </div>
                                <div class="col-md-6">
                                    <label for="linkedin_profile" class="form-label">LinkedIn</label>
                                    <input type="url" class="form-control" id="linkedin_profile" name="linkedin_profile" 
                                           placeholder="https://linkedin.com/in/seu-perfil">
                                </div>
                                <div class="col-md-6">
                                    <label for="portfolio_url" class="form-label">Portfólio/Site</label>
                                    <input type="url" class="form-control" id="portfolio_url" name="portfolio_url" 
                                           placeholder="https://seuportfolio.com">
                                </div>
                                <div class="col-md-6">
                                    <label for="referral_source" class="form-label">Como conheceu a vaga? *</label>
                                    <select class="form-control" id="referral_source" name="referral_source" required>
                                        <option value="">Selecione</option>
                                        <option value="site_empresa">Site da Empresa</option>
                                        <option value="linkedin">LinkedIn</option>
                                        <option value="indeed">Indeed</option>
                                        <option value="glassdoor">Glassdoor</option>
                                        <option value="facebook">Facebook</option>
                                        <option value="instagram">Instagram</option>
                                        <option value="indicacao">Indicação</option>
                                        <option value="evento">Evento</option>
                                        <option value="outro">Outro</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="resume_file" class="form-label">Currículo (PDF) *</label>
                                    <input type="file" class="form-control" id="resume_file" name="resume_file" accept=".pdf" required>
                                </div>
                                <div class="col-12">
                                    <label for="cover_letter" class="form-label">Carta de Apresentação</label>
                                    <textarea class="form-control" id="cover_letter" name="cover_letter" rows="4" 
                                              placeholder="Conte-nos mais sobre você, suas experiências e por que seria um ótimo fit para a equipe Kaizen."></textarea>
                                </div>
                            </div>
                            <div class="d-flex justify-content-between mt-4">
                                <button type="button" class="btn btn-outline-light" onclick="prevStep(3)">
                                    <i class="fas fa-arrow-left me-2"></i>Voltar
                                </button>
                                <button type="submit" class="btn btn-pink">
                                    <i class="fas fa-paper-plane me-2"></i>Enviar Candidatura
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Política de Privacidade -->
    <div class="container py-4">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="bg-dark p-4 rounded text-white">
                    <h4 class="text-pink mb-3">Política de Privacidade</h4>
                    <div class="text-white-50 small">
                        {{ page.privacy_policy|richtext }}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
let currentStep = 1;
const totalSteps = 4;

function nextStep(step) {
    if (validateStep(currentStep)) {
        document.getElementById(`step${currentStep}`).classList.add('d-none');
        document.getElementById(`step${step}`).classList.remove('d-none');
        currentStep = step;
        updateProgressBar();
    }
}

function prevStep(step) {
    document.getElementById(`step${currentStep}`).classList.add('d-none');
    document.getElementById(`step${step}`).classList.remove('d-none');
    currentStep = step;
    updateProgressBar();
}

function updateProgressBar() {
    const progress = (currentStep / totalSteps) * 100;
    // Implementar barra de progresso se necessário
}

function validateStep(step) {
    const stepElement = document.getElementById(`step${step}`);
    const requiredFields = stepElement.querySelectorAll('[required]');
    let isValid = true;
    
    requiredFields.forEach(field => {
        if (!field.value.trim()) {
            field.classList.add('is-invalid');
            isValid = false;
        } else {
            field.classList.remove('is-invalid');
        }
    });
    
    return isValid;
}

// Formatação de campos
document.getElementById('phone').addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    if (value.length >= 11) {
        value = value.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
    } else if (value.length >= 7) {
        value = value.replace(/(\d{2})(\d{4})(\d{0,4})/, '($1) $2-$3');
    }
    e.target.value = value;
});

document.getElementById('cpf').addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    if (value.length >= 11) {
        value = value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
    }
    e.target.value = value;
});

document.getElementById('zip_code').addEventListener('input', function(e) {
    let value = e.target.value.replace(/\D/g, '');
    if (value.length >= 8) {
        value = value.replace(/(\d{5})(\d{3})/, '$1-$2');
    }
    e.target.value = value;
});

// Envio do formulário
document.getElementById('recruitmentForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    if (!validateStep(currentStep)) {
        return;
    }
    
    const formData = new FormData(this);
    
    fetch('/recruitment/api/application/', {
        method: 'POST',
        body: formData,
        headers: {
            'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('Candidatura enviada com sucesso! Entraremos em contato em breve.');
            this.reset();
            currentStep = 1;
            document.getElementById('step4').classList.add('d-none');
            document.getElementById('step1').classList.remove('d-none');
        } else {
            alert('Erro ao enviar candidatura. Tente novamente.');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Erro ao enviar candidatura. Tente novamente.');
    });
});
</script>
{% endblock internal_content %}

